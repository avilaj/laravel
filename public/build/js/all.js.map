{"version":3,"sources":["app.js"],"names":[],"mappings":"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","file":"all.js","sourcesContent":["$(document).ready( ()=> {\r\n  let Slider = (selector, responsive) => {\r\n    let element = $(selector);\r\n    element.owlCarousel({\r\n      margin: 10,\r\n      nav: true,\r\n      navClass: ['owl-prev fa fa-angle-left', 'owl-next fa fa-angle-right'],\r\n      navText: false,\r\n      loop: true,\r\n      responsive: responsive\r\n    });\r\n  }\r\n\r\n  Slider(\"#news-slider\", {\r\n    0:{items: 2},\r\n    1000: {items: 4}\r\n  });\r\n\r\n  Slider(\".home-product-slider\", {\r\n    0: { items: 1 },\r\n    600: { items: 3 },\r\n    1000: { items: 5 }\r\n  });\r\n\r\n  var productThumbnails = $('.product-displayer__thumbnails');\r\n  productThumbnails.owlCarousel({\r\n    margin: 10,\r\n    nav: true,\r\n    navClass: ['owl-prev fa fa-angle-left', 'owl-next fa fa-angle-right'],\r\n    navText: false,\r\n    auto: false\r\n  });\r\n\r\n  let createImage = (src) => {\r\n    return $('<img src='+src+'>');\r\n  };\r\n\r\n  let setZoom = (medium, large) =>  {\r\n    let container = $('.product-displayer__view');\r\n    container.trigger('zoom.destroy');\r\n    container.html('');\r\n    container.append(createImage(medium));\r\n    container.zoom({\r\n      url: large\r\n    });\r\n  };\r\n\r\n  let productDisplayerThumbnails = $('.product-displayer__thumbnails');\r\n  productDisplayerThumbnails.on('click', 'img', (ev) => {\r\n    setZoom(ev.target.dataset.medium, ev.target.dataset.large);\r\n  });\r\n  $('.product-displayer__thumbnails img').first().trigger('click');\r\n});\r\n\r\nclass CartController {\r\n  constructor (CartService) {\r\n    'ngInject';\r\n    this.delegate = CartService;\r\n  }\r\n\r\n  totalPrice () {\r\n    let items = this.items();\r\n    let sum  = (a, b) => a * 1 + b * 1;\r\n    let getSubtotal = (item) => item.price * 1 * item.qty * 1;\r\n    let prices = items.map(getSubtotal);\r\n    let total = prices.reduce(sum, 0);\r\n\r\n    return total;\r\n  }\r\n\r\n  items() {\r\n    return this.delegate.items();\r\n  }\r\n\r\n  remove(item, index) {\r\n    this.delegate.remove(item, index);\r\n  }\r\n\r\n}\r\n\r\nclass ProductController {\r\n\r\n  constructor ($window, CartService) {\r\n    'ngInject';\r\n\r\n    this.cart = CartService;\r\n    this.store = $window.mkStore;\r\n    this.qty = 1;\r\n\r\n    this.store.references.map((ref)=> this.addStock(ref));\r\n    this.reference = this.getAvailableReference();\r\n  }\r\n\r\n  buy() {\r\n    return this.cart.update(this.reference.id, this.size.size_id, this.qty);\r\n  }\r\n\r\n  getAvailableReference() {\r\n    return this.store.references.filter(this.hasStock)[0];\r\n  }\r\n\r\n  sum (prev, item) {\r\n    return prev + item.stock  * 1;\r\n  };\r\n\r\n  addStock(reference) {\r\n    let stock = this.findSizes(reference).reduce(this.sum, 0);\r\n\r\n    reference.stock = stock;\r\n    return reference;\r\n  }\r\n\r\n  matchesReference (referenceId) {\r\n    return (item) => {\r\n      return referenceId == item.reference_id;\r\n    };\r\n  }\r\n\r\n  findSizes (reference) {\r\n    if (!reference) return [];\r\n    return this.store.sizes.filter(this.matchesReference(reference.id));\r\n  }\r\n\r\n  hasStock(entity) {\r\n    return !!entity && (entity.stock * 1) > 0;\r\n  }\r\n\r\n}\r\n\r\nclass CartService {\r\n  constructor($http, $window) {\r\n    'ngInject';\r\n    this.$window = $window;\r\n    this.$http = $http;\r\n\r\n    this.cart = {\r\n      qty: 0,\r\n      items: []\r\n    };\r\n    this.getStatus();\r\n  }\r\n\r\n  items() {\r\n    if (! this.cart) return [];\r\n    return  this.cart.items;\r\n  }\r\n\r\n  getStatus() {\r\n    return this.$http.get('/cart/status')\r\n      .then( (response) => {\r\n        console.log(response.data);\r\n        this.cart = response.data;\r\n      } );\r\n  }\r\n\r\n  remove(item, index) {\r\n    this.cart.items.splice(index, 1);\r\n    this.update(item.reference_id, item.size_id, 0);\r\n  }\r\n\r\n  update(reference_id, size_id, qty) {\r\n    let data = {reference_id, size_id, qty};\r\n    this.updating = true;\r\n    return this.$http.post('/cart/update', data)\r\n      .then( (response) => {\r\n        this.cart = response.data;\r\n        return this.cart;\r\n      }, (err) => {\r\n        if (err.status == 401) {\r\n          this.$window.location.href = '/login';\r\n        }\r\n      })\r\n      .then( res => {\r\n        this.updating = false;\r\n        return res;\r\n      });\r\n  }\r\n}\r\n\r\n\r\nangular.module('services', [])\r\n  .service('CartService', CartService)\r\n\r\nangular.module('mkcart-header', ['services'])\r\n  .controller('cartHeaderController', ['CartService', function (CartService) {\r\n    this.qty = () => CartService.items().length;\r\n  }])\r\n  .component('cartHeader', {\r\n    template: 'Mi carrito ({{ $ctrl.qty() }}) <i class=\"fa fa-shopping-cart\"></i>',\r\n    controller: 'cartHeaderController'\r\n  });\r\n\r\nangular.module('product-show', ['services'])\r\n  .controller('ProductController', ['$window', 'CartService', ProductController])\r\n  .controller('CartController', CartController)\r\n;\r\n\r\nangular.module('cart', ['services', 'mkcart-header', 'product-show'])\r\nangular.bootstrap(document.querySelector('body'), ['cart']);\r\n\r\n  // angular.bootstrap(document.getElementById('filtering'), ['filtering']);\r\n"],"sourceRoot":"/source/"}