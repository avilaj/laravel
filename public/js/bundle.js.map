{"version":3,"names":[],"mappings":"","sources":["bundle.js"],"sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nvar _newsletter = require('./newsletter/newsletter.module');\n\nvar _newsletter2 = _interopRequireDefault(_newsletter);\n\nvar _product = require('./product/product.controller');\n\nvar _product2 = _interopRequireDefault(_product);\n\nvar _cart = require('./cart/cart.service');\n\nvar _cart2 = _interopRequireDefault(_cart);\n\nvar _cart3 = require('./cart/cart.controller');\n\nvar _cart4 = _interopRequireDefault(_cart3);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n$(document).ready(function () {\n  var Slider = function Slider(selector, responsive) {\n    var element = $(selector);\n    element.owlCarousel({\n      margin: 10,\n      nav: true,\n      navClass: ['owl-prev fa fa-angle-left', 'owl-next fa fa-angle-right'],\n      navText: false,\n      loop: true,\n      responsive: responsive\n    });\n  };\n\n  Slider(\"#news-slider\", {\n    0: { items: 2 },\n    1000: { items: 4 }\n  });\n\n  Slider(\".home-product-slider\", {\n    0: { items: 1 },\n    600: { items: 3 },\n    1000: { items: 5 }\n  });\n\n  var productThumbnails = $('.product-displayer__thumbnails');\n  productThumbnails.owlCarousel({\n    margin: 10,\n    nav: true,\n    navClass: ['owl-prev fa fa-angle-left', 'owl-next fa fa-angle-right'],\n    navText: false,\n    auto: false\n  });\n\n  var createImage = function createImage(src) {\n    return $('<img src=' + src + '>');\n  };\n\n  var setZoom = function setZoom(medium, large) {\n    var container = $('.product-displayer__view');\n    container.trigger('zoom.destroy');\n    container.html('');\n    container.append(createImage(medium));\n    container.zoom({\n      url: large\n    });\n  };\n\n  var productDisplayerThumbnails = $('.product-displayer__thumbnails');\n  productDisplayerThumbnails.on('click', 'img', function (ev) {\n    setZoom(ev.target.dataset.medium, ev.target.dataset.large);\n  });\n  $('.product-displayer__thumbnails img').first().trigger('click');\n});\n\nangular.module('services', []).service('CartService', _cart2.default);\n\nangular.module('mkcart-header', ['services']).controller('cartHeaderController', ['CartService', function (CartService) {\n  this.qty = function () {\n    return CartService.items().length;\n  };\n}]).component('cartHeader', {\n  template: 'Mi carrito ({{ $ctrl.qty() }}) <i class=\"fa fa-shopping-cart\"></i>',\n  controller: 'cartHeaderController'\n});\n\nangular.module('product-show', ['services']).controller('ProductController', ['$window', 'CartService', _product2.default]).controller('CartController', _cart4.default);\n\nangular.module('cart', ['services', 'mkcart-header', 'product-show', _newsletter2.default]);\nangular.bootstrap(document.querySelector('body'), ['cart']);\n\n// angular.bootstrap(document.getElementById('filtering'), ['filtering']);\n\n},{\"./cart/cart.controller\":2,\"./cart/cart.service\":3,\"./newsletter/newsletter.module\":4,\"./product/product.controller\":6}],2:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar CartController = function () {\n  function CartController(CartService) {\n    'ngInject';\n\n    _classCallCheck(this, CartController);\n\n    this.delegate = CartService;\n  }\n\n  _createClass(CartController, [{\n    key: 'totalPrice',\n    value: function totalPrice() {\n      var items = this.items();\n      var sum = function sum(a, b) {\n        return a * 1 + b * 1;\n      };\n      var getSubtotal = function getSubtotal(item) {\n        return item.price * 1 * item.qty * 1;\n      };\n      var prices = items.map(getSubtotal);\n      var total = prices.reduce(sum, 0);\n\n      return total;\n    }\n  }, {\n    key: 'items',\n    value: function items() {\n      return this.delegate.items();\n    }\n  }, {\n    key: 'remove',\n    value: function remove(item, index) {\n      this.delegate.remove(item, index);\n    }\n  }]);\n\n  return CartController;\n}();\n\nexports.default = CartController;\n\n},{}],3:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar CartService = function () {\n  function CartService($http, $window) {\n    'ngInject';\n\n    _classCallCheck(this, CartService);\n\n    this.$window = $window;\n    this.$http = $http;\n\n    this.cart = {\n      qty: 0,\n      items: []\n    };\n    this.getStatus();\n  }\n\n  _createClass(CartService, [{\n    key: 'items',\n    value: function items() {\n      if (!this.cart) return [];\n      return this.cart.items;\n    }\n  }, {\n    key: 'getStatus',\n    value: function getStatus() {\n      var _this = this;\n\n      return this.$http.get('/cart/status').then(function (response) {\n        console.log(response.data);\n        _this.cart = response.data;\n      });\n    }\n  }, {\n    key: 'remove',\n    value: function remove(item, index) {\n      this.cart.items.splice(index, 1);\n      this.update(item.reference_id, item.size_id, 0);\n    }\n  }, {\n    key: 'update',\n    value: function update(reference_id, size_id, qty) {\n      var _this2 = this;\n\n      var data = { reference_id: reference_id, size_id: size_id, qty: qty };\n      this.updating = true;\n      return this.$http.post('/cart/update', data).then(function (response) {\n        _this2.cart = response.data;\n        return _this2.cart;\n      }, function (err) {\n        if (err.status == 401) {\n          _this2.$window.location.href = '/login';\n        }\n      }).then(function (res) {\n        _this2.updating = false;\n        return res;\n      });\n    }\n  }]);\n\n  return CartService;\n}();\n\nexports.default = CartService;\n\n},{}],4:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _subscribe = require('./subscribe.controller');\n\nvar _subscribe2 = _interopRequireDefault(_subscribe);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar template = '<div class=\"spinner\" ng-show=\"$ctrl.requesting\"></div>' + '<div class=\"message\" ng-show=\"$ctrl.message\">{{ $ctrl.message }}</div>' + '<form ng-submit=\"$ctrl.subscribe($ctrl.email)\" ng-hide=\"$ctrl.requesting || $ctrl.message\">' + '<input type=\"text\" ng-model=\"$ctrl.email\" placeholder=\"e-mail\"/>' + '<i class=\"fa fa-angle-right\"></i>' + '</form>';\n\nexports.default = angular.module('newsletter', []).controller(\"SubscribeController\", _subscribe2.default).component('newsletterSubscribe', {\n  template: template,\n  controller: 'SubscribeController'\n}).name;\n\n},{\"./subscribe.controller\":5}],5:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar SubscribeController = function () {\n  function SubscribeController($http) {\n    'ngInject';\n\n    _classCallCheck(this, SubscribeController);\n\n    this.$http = $http;\n    this.status = 'ok';\n    this.requesting = false;\n  }\n\n  _createClass(SubscribeController, [{\n    key: 'subscribe',\n    value: function subscribe(email) {\n      var _this = this;\n\n      this.requesting = true;\n      return this.$http.post('/subscriptions', {\n        email: email\n      }).then(function (response) {\n        _this.requesting = false;\n        _this.message = 'Excelente, pronto recibirás nuestras promos.';\n      }, function (err, status) {\n        _this.requesting = false;\n        if (err.status != 422) {\n          _this.message = 'Un error ha ocurrido';\n        }\n        if (err.data.email) {\n          _this.message = 'Ya te encuentras registrado.';\n        }\n      });\n    }\n  }]);\n\n  return SubscribeController;\n}();\n\nexports.default = SubscribeController;\n\n},{}],6:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ProductController = function () {\n  function ProductController($window, CartService) {\n    'ngInject';\n\n    var _this = this;\n\n    _classCallCheck(this, ProductController);\n\n    this.cart = CartService;\n    this.store = $window.mkStore;\n    this.qty = 1;\n\n    this.store.references.map(function (ref) {\n      return _this.addStock(ref);\n    });\n    this.reference = this.getAvailableReference();\n  }\n\n  _createClass(ProductController, [{\n    key: 'buy',\n    value: function buy() {\n      return this.cart.update(this.reference.id, this.size.size_id, this.qty);\n    }\n  }, {\n    key: 'getAvailableReference',\n    value: function getAvailableReference() {\n      return this.store.references.filter(this.hasStock)[0];\n    }\n  }, {\n    key: 'sum',\n    value: function sum(prev, item) {\n      return prev + item.stock * 1;\n    }\n  }, {\n    key: 'addStock',\n    value: function addStock(reference) {\n      var stock = this.findSizes(reference).reduce(this.sum, 0);\n\n      reference.stock = stock;\n      return reference;\n    }\n  }, {\n    key: 'matchesReference',\n    value: function matchesReference(referenceId) {\n      return function (item) {\n        return referenceId == item.reference_id;\n      };\n    }\n  }, {\n    key: 'findSizes',\n    value: function findSizes(reference) {\n      if (!reference) return [];\n      return this.store.sizes.filter(this.matchesReference(reference.id));\n    }\n  }, {\n    key: 'hasStock',\n    value: function hasStock(entity) {\n      return !!entity && entity.stock * 1 > 0;\n    }\n  }]);\n\n  return ProductController;\n}();\n\nexports.default = ProductController;\n\n},{}]},{},[1]);\n"],"file":"bundle.js","sourceRoot":"/source/"}